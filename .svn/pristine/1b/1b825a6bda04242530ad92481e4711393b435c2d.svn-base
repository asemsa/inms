<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;

use App\User;
use App\Assign;

class AssignController extends Controller
{
    //


    public function assign(){
        //baca data assigns dari database
        $assigns = Assign::all();
        return view('coordinator.assign')
            ->with('assigns', $assigns);
    }

    public function noStd(){
    	$count = 0;
		Assign::truncate();//reset 

    	$student = User::where('position', 5);
    	$facultysv = User::where('position', 3);

    	$noStd = $student->count();

    	$getStudents = $student->get()->toArray();
    	$getFacultysv = $facultysv->get()->toArray();

    	for ($i=0; $i < $noStd; $i++) { 
    		//echo ($getStudents[$i]['id']."=>".$getFacultysv[$i]['id']);
    		$assign = new Assign();
    		if(empty($getFacultysv[$i]['id'])){
    			if($getFacultysv[$count]['id'] == null){
    				$count = 0;
    			}
    			$assign->studentID = $getStudents[$i]['id'];
    			$assign->facultySVID = $getFacultysv[$count]['id'];
    			$count += 1;
    		}else{
    			$assign->studentID = $getStudents[$i]['id'];
    			$assign->facultySVID = $getFacultysv[$i]['id'];
    		}
    		$assign->save();
    	}

    	$assigns = Assign::all();

    	return view('coordinator.assign')
            ->with('assigns', $assigns);
    }
}
